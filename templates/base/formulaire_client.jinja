<!-- templates/base/formulaire_client.jinja - Design Professionnel -->
{% extends "base_principale.jinja" %}

{% block titre_page %}{{ action }} un client{% endblock %}

{% block contenu %}
<div class="container-fluid">
    <div class="row justify-content-center">
        <div class="col-xl-10">
            <!-- En-tête avec breadcrumb -->
            <div class="page-header mb-4">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb-modern">
                        <li class="breadcrumb-item">
                            <a href="/">
                                <i class="bi bi-house-door"></i> Accueil
                            </a>
                        </li>
                        <li class="breadcrumb-item">
                            <a href="/clients/">Clients</a>
                        </li>
                        <li class="breadcrumb-item active">{{ action }}</li>
                    </ol>
                </nav>
                <div class="page-title-wrapper">
                    <div class="page-title-icon">
                        <i class="bi bi-person-plus-fill"></i>
                    </div>
                    <div>
                        <h1 class="page-title">{{ action }} un client</h1>
                        <p class="page-subtitle">
                            {% if action == "Modifier" %}
                                Modifier les informations du client #{{ formulaire.instance.code|default('') }}
                            {% else %}
                                Créer un nouveau client dans votre base de données
                            {% endif %}
                        </p>
                    </div>
                </div>
            </div>

            <form method="post" class="needs-validation" novalidate>
                <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
                
                <div class="row g-4">
                    <!-- Colonne principale -->
                    <div class="col-lg-8">
                        <!-- Informations générales -->
                        <div class="form-card">
                            <div class="form-card-header">
                                <div class="form-card-icon bg-primary">
                                    <i class="bi bi-person-badge-fill"></i>
                                </div>
                                <div>
                                    <h3 class="form-card-title">Informations générales</h3>
                                    <p class="form-card-subtitle">Informations d'identification du client</p>
                                </div>
                            </div>
                            
                            <div class="form-card-body">
                                <div class="row g-4">
                                    <div class="col-md-6">
                                        <div class="form-group-modern">
                                            <label for="{{ formulaire.code.id_for_label }}" class="form-label-modern">
                                                <i class="bi bi-tag-fill"></i>
                                                Code client
                                                <span class="required-badge">Requis</span>
                                            </label>
                                            {{ formulaire.code }}
                                            {% if formulaire.code.errors %}
                                            <div class="form-error">
                                                <i class="bi bi-exclamation-circle"></i>
                                                {{ formulaire.code.errors.0 }}
                                            </div>
                                            {% endif %}
                                            <div class="form-help">
                                                <i class="bi bi-info-circle"></i>
                                                Identifiant unique (ex: CLI-001)
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="form-group-modern">
                                            <label for="{{ formulaire.nom.id_for_label }}" class="form-label-modern">
                                                <i class="bi bi-person-fill"></i>
                                                Nom complet
                                                <span class="required-badge">Requis</span>
                                            </label>
                                            {{ formulaire.nom }}
                                            {% if formulaire.nom.errors %}
                                            <div class="form-error">
                                                <i class="bi bi-exclamation-circle"></i>
                                                {{ formulaire.nom.errors.0 }}
                                            </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="form-group-modern">
                                            <label for="{{ formulaire.email.id_for_label }}" class="form-label-modern">
                                                <i class="bi bi-envelope-fill"></i>
                                                Adresse email
                                                <span class="required-badge">Requis</span>
                                            </label>
                                            {{ formulaire.email }}
                                            {% if formulaire.email.errors %}
                                            <div class="form-error">
                                                <i class="bi bi-exclamation-circle"></i>
                                                {{ formulaire.email.errors.0 }}
                                            </div>
                                            {% endif %}
                                            <div class="form-help">
                                                <i class="bi bi-info-circle"></i>
                                                Pour les communications et factures
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="form-group-modern">
                                            <label for="{{ formulaire.telephone.id_for_label }}" class="form-label-modern">
                                                <i class="bi bi-telephone-fill"></i>
                                                Téléphone
                                                <span class="required-badge">Requis</span>
                                            </label>
                                            {{ formulaire.telephone }}
                                            {% if formulaire.telephone.errors %}
                                            <div class="form-error">
                                                <i class="bi bi-exclamation-circle"></i>
                                                {{ formulaire.telephone.errors.0 }}
                                            </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Adresse -->
                        <div class="form-card">
                            <div class="form-card-header">
                                <div class="form-card-icon bg-info">
                                    <i class="bi bi-geo-alt-fill"></i>
                                </div>
                                <div>
                                    <h3 class="form-card-title">Localisation</h3>
                                    <p class="form-card-subtitle">Adresse et coordonnées géographiques</p>
                                </div>
                            </div>
                            
                            <div class="form-card-body">
                                <div class="row g-4">
                                    <div class="col-12">
                                        <div class="form-group-modern">
                                            <label for="{{ formulaire.adresse.id_for_label }}" class="form-label-modern">
                                                <i class="bi bi-house-door-fill"></i>
                                                Adresse complète
                                            </label>
                                            {{ formulaire.adresse }}
                                            {% if formulaire.adresse.errors %}
                                            <div class="form-error">
                                                <i class="bi bi-exclamation-circle"></i>
                                                {{ formulaire.adresse.errors.0 }}
                                            </div>
                                            {% endif %}
                                            <div class="form-help">
                                                <i class="bi bi-info-circle"></i>
                                                Numéro, rue, quartier
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="form-group-modern">
                                            <label for="{{ formulaire.ville.id_for_label }}" class="form-label-modern">
                                                <i class="bi bi-building"></i>
                                                Ville
                                            </label>
                                            {{ formulaire.ville }}
                                            {% if formulaire.ville.errors %}
                                            <div class="form-error">
                                                <i class="bi bi-exclamation-circle"></i>
                                                {{ formulaire.ville.errors.0 }}
                                            </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="form-group-modern">
                                            <label for="{{ formulaire.pays.id_for_label }}" class="form-label-modern">
                                                <i class="bi bi-flag-fill"></i>
                                                Pays
                                            </label>
                                            {{ formulaire.pays }}
                                            {% if formulaire.pays.errors %}
                                            <div class="form-error">
                                                <i class="bi bi-exclamation-circle"></i>
                                                {{ formulaire.pays.errors.0 }}
                                            </div>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Informations financières -->
                        <div class="form-card">
                            <div class="form-card-header">
                                <div class="form-card-icon bg-success">
                                    <i class="bi bi-cash-stack"></i>
                                </div>
                                <div>
                                    <h3 class="form-card-title">Informations financières</h3>
                                    <p class="form-card-subtitle">Crédit et fiscalité</p>
                                </div>
                            </div>
                            
                            <div class="form-card-body">
                                <div class="row g-4">
                                    <div class="col-md-6">
                                        <div class="form-group-modern">
                                            <label for="{{ formulaire.numero_fiscal.id_for_label }}" class="form-label-modern">
                                                <i class="bi bi-file-text-fill"></i>
                                                Numéro fiscal (NINEA)
                                            </label>
                                            {{ formulaire.numero_fiscal }}
                                            {% if formulaire.numero_fiscal.errors %}
                                            <div class="form-error">
                                                <i class="bi bi-exclamation-circle"></i>
                                                {{ formulaire.numero_fiscal.errors.0 }}
                                            </div>
                                            {% endif %}
                                            <div class="form-help">
                                                <i class="bi bi-info-circle"></i>
                                                Numéro d'identification fiscale
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="col-md-6">
                                        <div class="form-group-modern">
                                            <label for="{{ formulaire.limite_credit.id_for_label }}" class="form-label-modern">
                                                <i class="bi bi-credit-card-fill"></i>
                                                Limite de crédit
                                            </label>
                                            <div class="input-group-modern">
                                                {{ formulaire.limite_credit }}
                                                <span class="input-addon">FCFA</span>
                                            </div>
                                            {% if formulaire.limite_credit.errors %}
                                            <div class="form-error">
                                                <i class="bi bi-exclamation-circle"></i>
                                                {{ formulaire.limite_credit.errors.0 }}
                                            </div>
                                            {% endif %}
                                            <div class="form-help">
                                                <i class="bi bi-info-circle"></i>
                                                Plafond d'achat autorisé à crédit
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Colonne latérale -->
                    <div class="col-lg-4">
                        <!-- Statut -->
                        <div class="form-card">
                            <div class="form-card-header">
                                <div class="form-card-icon bg-warning">
                                    <i class="bi bi-toggle-on"></i>
                                </div>
                                <div>
                                    <h3 class="form-card-title">Statut</h3>
                                    <p class="form-card-subtitle">État du compte client</p>
                                </div>
                            </div>
                            
                            <div class="form-card-body">
                                <div class="status-switch-card">
                                    <div class="status-switch-header">
                                        <div class="status-switch-label">
                                            <i class="bi bi-person-check"></i>
                                            Client actif
                                        </div>
                                        <div class="toggle-switch">
                                            {{ formulaire.est_actif }}
                                            <label for="{{ formulaire.est_actif.id_for_label }}" class="toggle-label"></label>
                                        </div>
                                    </div>
                                    <div class="status-switch-help">
                                        <i class="bi bi-info-circle"></i>
                                        Un client inactif ne pourra pas passer de nouvelles commandes
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Analyse crédit -->
                        <div class="form-card">
                            <div class="form-card-header">
                                <div class="form-card-icon bg-gradient">
                                    <i class="bi bi-graph-up-arrow"></i>
                                </div>
                                <div>
                                    <h3 class="form-card-title">Analyse crédit</h3>
                                    <p class="form-card-subtitle">Évaluation automatique</p>
                                </div>
                            </div>
                            
                            <div class="form-card-body">
                                <div class="credit-analysis">
                                    <div class="credit-metric">
                                        <div class="metric-label">Type de client</div>
                                        <div class="metric-value" id="type-client">
                                            {% if formulaire.instance.limite_credit and formulaire.instance.limite_credit > 0 %}
                                                Avec crédit
                                            {% else %}
                                                Comptant
                                            {% endif %}
                                        </div>
                                        <div class="metric-icon">
                                            <i class="bi bi-wallet2"></i>
                                        </div>
                                    </div>
                                    
                                    <div class="credit-metric">
                                        <div class="metric-label">Niveau de risque</div>
                                        <div class="metric-value risk-level" id="niveau-risque">Faible</div>
                                        <div class="metric-icon">
                                            <i class="bi bi-shield-check"></i>
                                        </div>
                                    </div>
                                    
                                    <div class="credit-metric">
                                        <div class="metric-label">Score solvabilité</div>
                                        <div class="metric-value score-value" id="score-solvabilite">
                                            <span class="score-number">95</span>
                                            <span class="score-max">/100</span>
                                        </div>
                                        <div class="metric-icon">
                                            <i class="bi bi-speedometer2"></i>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="risk-gauge">
                                    <div class="gauge-label">Limite recommandée</div>
                                    <div class="gauge-value" id="limite-recommandee">100 000 FCFA</div>
                                    <div class="gauge-bar">
                                        <div class="gauge-fill" id="gauge-fill" style="width: 50%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Conseils -->
                        <div class="tips-card">
                            <div class="tips-header">
                                <i class="bi bi-lightbulb-fill"></i>
                                <span>Conseils</span>
                            </div>
                            <div class="tips-list">
                                <div class="tip-item">
                                    <i class="bi bi-check-circle-fill"></i>
                                    <span>Utilisez un système de code cohérent</span>
                                </div>
                                <div class="tip-item">
                                    <i class="bi bi-check-circle-fill"></i>
                                    <span>Évaluez la solvabilité avant d'accorder du crédit</span>
                                </div>
                                <div class="tip-item">
                                    <i class="bi bi-check-circle-fill"></i>
                                    <span>Gardez les coordonnées à jour</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Barre d'actions fixe -->
                <div class="action-bar">
                    <div class="action-bar-content">
                        <div class="action-bar-left">
                            <i class="bi bi-info-circle"></i>
                            <span>Les champs marqués "Requis" sont obligatoires</span>
                        </div>
                        <div class="action-bar-right">
                            <a href="/clients/" class="btn-action-secondary">
                                <i class="bi bi-x-circle"></i>
                                Annuler
                            </a>
                            <button type="submit" class="btn-action-primary">
                                <i class="bi bi-check-circle"></i>
                                Enregistrer le client
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Calcul intelligent du risque et recommandations
    const limiteCreditInput = document.getElementById('{{ formulaire.limite_credit.id_for_label }}');
    const typeClientElement = document.getElementById('type-client');
    const niveauRisqueElement = document.getElementById('niveau-risque');
    const scoreSolvabiliteElement = document.getElementById('score-solvabilite');
    const limiteRecommandeeElement = document.getElementById('limite-recommandee');
    const gaugeFillElement = document.getElementById('gauge-fill');
    
    function calculerAnalyseCredit() {
        const limiteCredit = parseFloat(limiteCreditInput.value) || 0;
        
        // Type de client
        if (limiteCredit > 0) {
            typeClientElement.textContent = 'Avec crédit';
            typeClientElement.className = 'metric-value type-credit';
        } else {
            typeClientElement.textContent = 'Comptant';
            typeClientElement.className = 'metric-value type-comptant';
        }
        
        // Niveau de risque
        let risque, score, recommandation, gaugePercent;
        
        if (limiteCredit === 0) {
            risque = 'Aucun';
            score = 100;
            recommandation = '100 000';
            gaugePercent = 20;
            niveauRisqueElement.className = 'metric-value risk-none';
        } else if (limiteCredit <= 100000) {
            risque = 'Faible';
            score = 95;
            recommandation = '150 000';
            gaugePercent = 30;
            niveauRisqueElement.className = 'metric-value risk-low';
        } else if (limiteCredit <= 500000) {
            risque = 'Moyen';
            score = 75;
            recommandation = '500 000';
            gaugePercent = 60;
            niveauRisqueElement.className = 'metric-value risk-medium';
        } else {
            risque = 'Élevé';
            score = 55;
            recommandation = '1 000 000';
            gaugePercent = 100;
            niveauRisqueElement.className = 'metric-value risk-high';
        }
        
        niveauRisqueElement.textContent = risque;
        scoreSolvabiliteElement.querySelector('.score-number').textContent = score;
        limiteRecommandeeElement.textContent = recommandation + ' FCFA';
        gaugeFillElement.style.width = gaugePercent + '%';
        
        // Animer le changement
        gaugeFillElement.style.transition = 'width 0.5s ease';
    }
    
    if (limiteCreditInput) {
        limiteCreditInput.addEventListener('input', calculerAnalyseCredit);
        calculerAnalyseCredit(); // Calcul initial
    }
    
    // Validation du formulaire
    const form = document.querySelector('form.needs-validation');
    if (form) {
        form.addEventListener('submit', function(event) {
            if (!form.checkValidity()) {
                event.preventDefault();
                event.stopPropagation();
            }
            form.classList.add('was-validated');
        });
    }
    
    // Formatage automatique des champs
    const numeroFiscalField = document.getElementById('{{ formulaire.numero_fiscal.id_for_label }}');
    if (numeroFiscalField) {
        numeroFiscalField.addEventListener('input', function() {
            let value = this.value.replace(/\D/g, '');
            if (value.length > 0) {
                value = value.match(/.{1,3}/g).join(' ');
            }
            this.value = value;
        });
    }
    
    // Animation de scroll pour la barre d'actions
    let lastScroll = 0;
    const actionBar = document.querySelector('.action-bar');
    
    window.addEventListener('scroll', function() {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll > 300) {
            actionBar.classList.add('visible');
        } else {
            actionBar.classList.remove('visible');
        }
        
        lastScroll = currentScroll;
    });
});
</script>

<style>
/* ==================== PAGE HEADER ==================== */
.page-header {
    margin-bottom: 32px;
}

.breadcrumb-modern {
    display: flex;
    gap: 8px;
    padding: 0;
    margin: 0;
    list-style: none;
    font-size: 13px;
}

.breadcrumb-modern li {
    display: flex;
    align-items: center;
    gap: 8px;
    color: #64748b;
}

.breadcrumb-modern li::after {
    content: '/';
    color: #cbd5e1;
}

.breadcrumb-modern li:last-child::after {
    display: none;
}

.breadcrumb-modern a {
    color: #64748b;
    text-decoration: none;
    transition: color 0.2s;
}

.breadcrumb-modern a:hover {
    color: #1e40af;
}

.breadcrumb-item.active {
    color: #1e40af;
    font-weight: 600;
}

.page-title-wrapper {
    display: flex;
    align-items: center;
    gap: 20px;
    margin-top: 16px;
}

.page-title-icon {
    width: 60px;
    height: 60px;
    background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 28px;
    color: white;
    box-shadow: 0 8px 16px rgba(30, 64, 175, 0.2);
}

.page-title {
    font-size: 32px;
    font-weight: 700;
    color: #1e293b;
    margin: 0;
    line-height: 1;
}

.page-subtitle {
    font-size: 14px;
    color: #64748b;
    margin: 8px 0 0 0;
}

/* ==================== FORM CARDS ==================== */
.form-card {
    background: white;
    border-radius: 16px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    margin-bottom: 24px;
    overflow: hidden;
}

.form-card-header {
    padding: 24px;
    background: #f8fafc;
    border-bottom: 1px solid #e2e8f0;
    display: flex;
    align-items: center;
    gap: 16px;
}

.form-card-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    color: white;
    flex-shrink: 0;
}

.form-card-icon.bg-primary { background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%); }
.form-card-icon.bg-info { background: linear-gradient(135deg, #0ea5e9 0%, #38bdf8 100%); }
.form-card-icon.bg-success { background: linear-gradient(135deg, #10b981 0%, #34d399 100%); }
.form-card-icon.bg-warning { background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%); }
.form-card-icon.bg-gradient { background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%); }

.form-card-title {
    font-size: 18px;
    font-weight: 700;
    color: #1e293b;
    margin: 0;
}

.form-card-subtitle {
    font-size: 13px;
    color: #64748b;
    margin: 4px 0 0 0;
}

.form-card-body {
    padding: 24px;
}

/* ==================== FORM GROUPS ==================== */
.form-group-modern {
    margin-bottom: 0;
}

.form-label-modern {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    font-weight: 600;
    color: #475569;
    margin-bottom: 8px;
}

.form-label-modern i {
    color: #94a3b8;
}

.required-badge {
    margin-left: auto;
    padding: 2px 8px;
    background: #fee2e2;
    color: #991b1b;
    border-radius: 4px;
    font-size: 11px;
    font-weight: 600;
}

.form-control, .form-select, textarea {
    width: 100%;
    padding: 12px 16px;
    border: 2px solid #e2e8f0;
    border-radius: 10px;
    font-size: 14px;
    transition: all 0.2s ease;
    background: white;
}

.form-control:focus, .form-select:focus, textarea:focus {
    outline: none;
    border-color: #1e40af;
    box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1);
}

textarea {
    resize: vertical;
    min-height: 100px;
}

.input-group-modern {
    display: flex;
    gap: 0;
}

.input-group-modern .form-control {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}

.input-addon {
    padding: 12px 16px;
    background: #f1f5f9;
    border: 2px solid #e2e8f0;
    border-left: none;
    border-top-right-radius: 10px;
    border-bottom-right-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    color: #64748b;
}

.form-error {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-top: 8px;
    padding: 8px 12px;
    background: #fee2e2;
    border-left: 3px solid #ef4444;
    border-radius: 6px;
    font-size: 13px;
    color: #991b1b;
}

.form-help {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-top: 6px;
    font-size: 12px;
    color: #94a3b8;
}

.form-help i {
    font-size: 14px;
}

/* ==================== STATUS SWITCH ==================== */
.status-switch-card {
    padding: 20px;
    background: #f8fafc;
    border-radius: 12px;
}

.status-switch-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.status-switch-label {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 15px;
    font-weight: 600;
    color: #1e293b;
}

.status-switch-label i {
    font-size: 18px;
    color: #1e40af;
}

.toggle-switch {
    position: relative;
}

.toggle-switch input[type="checkbox"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-label {
    display: block;
    width: 48px;
    height: 28px;
    background: #cbd5e1;
    border-radius: 14px;
    cursor: pointer;
    transition: background 0.3s ease;
    position: relative;
}

.toggle-label::after {
    content: '';
    position: absolute;
    width: 22px;
    height: 22px;
    background: white;
    border-radius: 50%;
    top: 3px;
    left: 3px;
    transition: transform 0.3s ease;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.toggle-switch input[type="checkbox"]:checked + .toggle-label {
    background: #1e40af;
}

.toggle-switch input[type="checkbox"]:checked + .toggle-label::after {
    transform: translateX(20px);
}

.status-switch-help {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: #64748b;
}

/* ==================== CREDIT ANALYSIS ==================== */
.credit-analysis {
    display: grid;
    gap: 16px;
    margin-bottom: 20px;
}

.credit-metric {
    padding: 16px;
    background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: all 0.3s ease;
}

.credit-metric:hover {
    border-color: #1e40af;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

.metric-label {
    font-size: 12px;
    color: #64748b;
    margin-bottom: 4px;
}

.metric-value {
    font-size: 18px;
    font-weight: 700;
    color: #1e293b;
    transition: color 0.3s ease;
}

.metric-value.type-credit { color: #1e40af; }
.metric-value.type-comptant { color: #10b981; }
.metric-value.risk-none { color: #10b981; }
.metric-value.risk-low { color: #10b981; }
.metric-value.risk-medium { color: #f59e0b; }
.metric-value.risk-high { color: #ef4444; }

.metric-icon {
    width: 40px;
    height: 40px;
    background: #f1f5f9;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    color: #64748b;
}

.score-value {
    display: flex;
    align-items: baseline;
    gap: 4px;
}

.score-number {
    font-size: 28px;
    color: #1e40af;
}

.score-max {
    font-size: 14px;
    color: #94a3b8;
}

/* ==================== RISK GAUGE ==================== */
.risk-gauge {
    padding: 16px;
    background: #f8fafc;
    border-radius: 12px;
}

.gauge-label {
    font-size: 12px;
    color: #64748b;
    margin-bottom: 6px;
}

.gauge-value {
    font-size: 20px;
    font-weight: 700;
    color: #1e40af;
    margin-bottom: 12px;
}

.gauge-bar {
    height: 8px;
    background: #e2e8f0;
    border-radius: 4px;
    overflow: hidden;
}

.gauge-fill {
    height: 100%;
    background: linear-gradient(90deg, #10b981 0%, #1e40af 50%, #ef4444 100%);
    border-radius: 4px;
    transition: width 0.5s ease;
}

/* ==================== TIPS CARD ==================== */
.tips-card {
    background: linear-gradient(135deg, #fef3c7 0%, #fef9c3 100%);
    border-radius: 16px;
    padding: 20px;
    border: 2px solid #fbbf24;
}

.tips-header {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 16px;
    font-weight: 700;
    color: #92400e;
    margin-bottom: 16px;
}

.tips-header i {
    font-size: 20px;
}

.tips-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.tip-item {
    display: flex;
    align-items: start;
    gap: 10px;
    font-size: 13px;
    color: #78350f;
}

.tip-item i {
    color: #10b981;
    font-size: 16px;
    flex-shrink: 0;
    margin-top: 2px;
}

/* ==================== ACTION BAR ==================== */
.action-bar {
    position: fixed;
    bottom: -100px;
    left: 0;
    right: 0;
    background: white;
    border-top: 1px solid #e2e8f0;
    box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.08);
    z-index: 1000;
    transition: bottom 0.3s ease;
}

.action-bar.visible {
    bottom: 0;
}

.action-bar-content {
    max-width: 1400px;
    margin: 0 auto;
    padding: 16px 24px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.action-bar-left {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    color: #64748b;
}

.action-bar-right {
    display: flex;
    gap: 12px;
}

.btn-action-primary, .btn-action-secondary {
    padding: 12px 24px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    transition: all 0.2s ease;
    text-decoration: none;
    border: none;
}

.btn-action-primary {
    background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
    color: white;
}

.btn-action-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 16px rgba(30, 64, 175, 0.3);
}

.btn-action-secondary {
    background: white;
    color: #64748b;
    border: 2px solid #e2e8f0;
}

.btn-action-secondary:hover {
    background: #f8fafc;
    border-color: #cbd5e1;
}

/* ==================== RESPONSIVE ==================== */
@media (max-width: 992px) {
    .page-title {
        font-size: 24px;
    }
    
    .page-title-icon {
        width: 48px;
        height: 48px;
        font-size: 20px;
    }
    
    .form-card-body {
        padding: 20px;
    }
    
    .action-bar-content {
        flex-direction: column;
        gap: 12px;
    }
    
    .action-bar-right {
        width: 100%;
    }
    
    .btn-action-primary, .btn-action-secondary {
        flex: 1;
        justify-content: center;
    }
}
</style>
{% endblock %}