<!-- templates/accounts/modifier_profil.jinja - MODIFICATION DU PROFIL -->
{% extends "base_principale.jinja" %}
{% block titre_page %}Modifier mon profil{% endblock %}
{% block contenu %}
<div class="container-fluid">
    <div class="form-header-modern">
        <div class="header-left">
            <a href="/accounts/profil/" class="btn-back"><i class="bi bi-arrow-left"></i></a>
            <div class="header-icon-box"><i class="bi bi-person-gear"></i></div>
            <div>
                <h4 class="header-title">Modifier mon profil</h4>
                <p class="header-subtitle">Mettez à jour vos informations personnelles</p>
            </div>
        </div>
    </div>
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="form-card-modern">
                <div class="form-card-header">
                    <div class="form-icon-box"><i class="bi bi-pencil-square"></i></div>
                    <h6 class="form-card-title">Informations personnelles</h6>
                </div>
                <div class="form-card-body">
                    <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="form-row">
                            <div class="form-group-modern">
                                <label class="form-label-modern"><i class="bi bi-person"></i>Prénom</label>
                                <div class="input-group-modern">
                                    <i class="bi bi-person input-icon"></i>
                                    <input type="text" name="first_name" class="form-control-modern" value="{{ user.first_name }}" placeholder="Votre prénom">
                                </div>
                            </div>
                            <div class="form-group-modern">
                                <label class="form-label-modern"><i class="bi bi-person"></i>Nom</label>
                                <div class="input-group-modern">
                                    <i class="bi bi-person input-icon"></i>
                                    <input type="text" name="last_name" class="form-control-modern" value="{{ user.last_name }}" placeholder="Votre nom">
                                </div>
                            </div>
                        </div>
                        <div class="form-group-modern">
                            <label class="form-label-modern required"><i class="bi bi-envelope"></i>Email</label>
                            <div class="input-group-modern">
                                <i class="bi bi-envelope input-icon"></i>
                                <input type="email" name="email" class="form-control-modern" value="{{ user.email }}" placeholder="votre.email@exemple.com" required>
                            </div>
                        </div>
                        <div class="form-group-modern">
                            <label class="form-label-modern"><i class="bi bi-telephone"></i>Téléphone</label>
                            <div class="input-group-modern">
                                <i class="bi bi-telephone input-icon"></i>
                                <input type="tel" name="telephone" class="form-control-modern" value="{{ profil.telephone }}" placeholder="+221 XX XXX XX XX">
                            </div>
                        </div>
                        <div class="form-group-modern">
                            <label class="form-label-modern"><i class="bi bi-geo-alt"></i>Adresse</label>
                            <div class="input-group-modern">
                                <i class="bi bi-geo-alt input-icon"></i>
                                <textarea name="adresse" class="form-control-modern" rows="3" placeholder="Votre adresse complète">{{ profil.adresse }}</textarea>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group-modern">
                                <label class="form-label-modern"><i class="bi bi-building"></i>Ville</label>
                                <div class="input-group-modern">
                                    <i class="bi bi-building input-icon"></i>
                                    <input type="text" name="ville" class="form-control-modern" value="{{ profil.ville }}" placeholder="Dakar">
                                </div>
                            </div>
                            <div class="form-group-modern">
                                <label class="form-label-modern"><i class="bi bi-mailbox"></i>Code postal</label>
                                <div class="input-group-modern">
                                    <i class="bi bi-mailbox input-icon"></i>
                                    <input type="text" name="code_postal" class="form-control-modern" value="{{ profil.code_postal }}" placeholder="00000">
                                </div>
                            </div>
                        </div>
                        <div class="form-group-modern">
                            <label class="form-label-modern"><i class="bi bi-image"></i>Photo de profil</label>
                            <div class="photo-upload-container">
                                {# Afficher la photo actuelle OU les initiales #}
                                {% if profil and profil.photo and profil.photo.name %}
                                    <div class="current-photo">
                                        <img src="{{ profil.photo.url }}" alt="Photo actuelle">
                                    </div>
                                {% else %}
                                    <div class="current-photo">
                                        <div class="user-avatar-placeholder-large">
                                            {{ user.first_name[0]|upper if user.first_name else user.username[0]|upper }}{{ user.last_name[0]|upper if user.last_name else '' }}
                                        </div>
                                    </div>
                                {% endif %}
                                <input type="file" name="photo" class="form-control-modern" accept="image/*">
                                <p class="form-help-text"><i class="bi bi-info-circle"></i>Formats acceptés : JPG, PNG. Taille max : 2 Mo</p>
                            </div>
                        </div>
                        <div class="form-actions">
                            <a href="/accounts/profil/" class="btn-secondary"><i class="bi bi-x-circle"></i><span>Annuler</span></a>
                            <button type="submit" class="btn-primary"><i class="bi bi-check-circle"></i><span>Enregistrer</span></button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
<style>
.form-header-modern{background:#fff;border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,.04);padding:24px 32px;margin-bottom:24px}.header-left{display:flex;align-items:center;gap:16px}.btn-back{width:44px;height:44px;border-radius:10px;background:#f1f5f9;color:#64748b;display:flex;align-items:center;justify-content:center;text-decoration:none;transition:all .2s}.btn-back:hover{background:#6366f1;color:#fff}.header-icon-box{width:54px;height:54px;background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 100%);border-radius:14px;display:flex;align-items:center;justify-content:center}.header-icon-box i{font-size:26px;color:#fff}.header-title{font-size:20px;font-weight:700;color:#1e293b;margin:0}.header-subtitle{font-size:13px;color:#64748b;margin:0}.form-card-modern{background:#fff;border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,.04);overflow:hidden}.form-card-header{padding:20px 24px;background:linear-gradient(135deg,#f8fafc 0%,#fff 100%);border-bottom:1px solid #e2e8f0;display:flex;align-items:center;gap:12px}.form-icon-box{width:42px;height:42px;background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 100%);border-radius:10px;display:flex;align-items:center;justify-content:center}.form-icon-box i{font-size:20px;color:#fff}.form-card-title{font-size:16px;font-weight:700;color:#1e293b;margin:0}.form-card-body{padding:32px}.form-row{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-bottom:20px}.form-group-modern{margin-bottom:20px}.form-label-modern{font-size:14px;font-weight:600;color:#475569;margin-bottom:8px;display:flex;align-items:center;gap:6px}.form-label-modern.required::after{content:'*';color:#ef4444;margin-left:4px}.form-label-modern i{color:#6366f1}.input-group-modern{position:relative}.input-icon{position:absolute;left:16px;top:50%;transform:translateY(-50%);color:#94a3b8;font-size:18px;pointer-events:none}.form-control-modern{width:100%;padding:12px 16px 12px 48px;border:2px solid #e2e8f0;border-radius:10px;font-size:14px;transition:all .3s;background:#fff}.form-control-modern:focus{outline:0;border-color:#6366f1;box-shadow:0 0 0 4px rgba(99,102,241,.1)}textarea.form-control-modern{resize:vertical;min-height:80px}.photo-upload-container{display:flex;flex-direction:column;gap:12px}.current-photo{width:120px;height:120px;border-radius:12px;overflow:hidden;border:2px solid #e2e8f0;display:flex;align-items:center;justify-content:center;background:#f8fafc}.current-photo img{width:100%;height:100%;object-fit:cover}.user-avatar-placeholder-large{width:100%;height:100%;background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 100%);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:48px}.form-help-text{font-size:12px;color:#64748b;margin-top:6px;display:flex;align-items:center;gap:4px}.form-help-text i{color:#6366f1;font-size:14px}.form-actions{display:flex;gap:12px;justify-content:flex-end;margin-top:32px;padding-top:24px;border-top:1px solid #e2e8f0}.btn-secondary{padding:12px 24px;background:#f1f5f9;color:#64748b;border:2px solid #e2e8f0;border-radius:10px;font-size:14px;font-weight:600;display:flex;align-items:center;gap:8px;cursor:pointer;text-decoration:none;transition:all .3s}.btn-secondary:hover{background:#fff;border-color:#94a3b8;color:#475569}.btn-primary{padding:12px 24px;background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 100%);color:#fff;border:0;border-radius:10px;font-size:14px;font-weight:600;display:flex;align-items:center;gap:8px;cursor:pointer;transition:all .3s}.btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 16px rgba(99,102,241,.3)}@media(max-width:768px){.form-row{grid-template-columns:1fr}.form-actions{flex-direction:column-reverse}.btn-secondary,.btn-primary{width:100%;justify-content:center}}
</style>
{% endblock %}
