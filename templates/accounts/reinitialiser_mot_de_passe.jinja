<!-- templates/accounts/reinitialiser_mot_de_passe.jinja - RÉINITIALISATION MOT DE PASSE -->
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Réinitialiser mon mot de passe - ERP MEA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}.reset-container{width:100%;max-width:500px}.reset-card{background:#fff;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,.3);overflow:hidden}.reset-header{background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 100%);padding:40px 30px;text-align:center;color:#fff}.reset-icon{width:80px;height:80px;background:rgba(255,255,255,.2);border-radius:20px;display:flex;align-items:center;justify-content:center;margin:0 auto 20px;backdrop-filter:blur(10px)}.reset-icon i{font-size:40px}.reset-header h1{font-size:26px;font-weight:700;margin-bottom:8px}.reset-header p{font-size:14px;opacity:.9;margin:0}.reset-body{padding:40px 30px}.alert{padding:12px 16px;border-radius:10px;margin-bottom:20px;font-size:14px;display:flex;align-items:center;gap:10px}.alert-error{background:#fee2e2;color:#991b1b;border:1px solid #fca5a5}.alert i{font-size:18px}.form-group{margin-bottom:24px}.form-label{font-size:14px;font-weight:600;color:#475569;margin-bottom:8px;display:flex;align-items:center;gap:6px}.form-label i{color:#6366f1;font-size:16px}.input-group{position:relative}.input-icon{position:absolute;left:16px;top:50%;transform:translateY(-50%);color:#94a3b8;font-size:18px;pointer-events:none}.form-control{width:100%;padding:14px 48px 14px 48px;border:2px solid #e2e8f0;border-radius:12px;font-size:15px;transition:all .3s;background:#fff}.form-control:focus{outline:0;border-color:#6366f1;box-shadow:0 0 0 4px rgba(99,102,241,.1)}.password-toggle{position:absolute;right:16px;top:50%;transform:translateY(-50%);background:0 0;border:0;color:#94a3b8;cursor:pointer;font-size:18px;padding:4px}.password-toggle:hover{color:#6366f1}.password-strength{margin-top:8px;height:4px;background:#e2e8f0;border-radius:2px;overflow:hidden}.strength-bar{height:100%;width:0;transition:all .3s;border-radius:2px}.strength-weak{background:#ef4444;width:33%}.strength-medium{background:#f59e0b;width:66%}.strength-strong{background:#10b981;width:100%}.pwd-help{font-size:12px;color:#64748b;margin-top:6px;display:flex;align-items:center;gap:4px}.pwd-help i{color:#6366f1;font-size:14px}.btn-reset{width:100%;padding:14px;background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 100%);color:#fff;border:0;border-radius:12px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s;display:flex;align-items:center;justify-content:center;gap:8px}.btn-reset:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(99,102,241,.4)}.reset-footer{text-align:center;padding:20px 30px;background:#f8fafc;border-top:1px solid #e2e8f0}.reset-footer p{font-size:13px;color:#64748b;margin:0}.reset-footer a{color:#6366f1;text-decoration:none;font-weight:600}.reset-footer a:hover{text-decoration:underline}@media(max-width:576px){.reset-body{padding:30px 20px}.reset-header{padding:30px 20px}}
    </style>
</head>
<body>
    <div class="reset-container">
        <div class="reset-card">
            <div class="reset-header">
                <div class="reset-icon"><i class="bi bi-shield-lock"></i></div>
                <h1>Nouveau mot de passe</h1>
                <p>Choisissez un mot de passe sécurisé</p>
            </div>
            
            <div class="reset-body">
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-error">
                            <i class="bi bi-exclamation-circle"></i>
                            <span>{{ message }}</span>
                        </div>
                    {% endfor %}
                {% endif %}
                
                <form method="post">
                    {% csrf_token %}
                    
                    <div class="form-group">
                        <label class="form-label">
                            <i class="bi bi-lock-fill"></i>
                            Nouveau mot de passe
                        </label>
                        <div class="input-group">
                            <i class="bi bi-lock-fill input-icon"></i>
                            <input 
                                type="password" 
                                name="new_password1" 
                                id="new_password1"
                                class="form-control" 
                                placeholder="Min. 8 caractères"
                                required
                                minlength="8"
                                oninput="checkPasswordStrength()"
                            >
                            <button type="button" class="password-toggle" onclick="togglePassword('new_password1', 'icon1')">
                                <i class="bi bi-eye" id="icon1"></i>
                            </button>
                        </div>
                        <div class="password-strength">
                            <div class="strength-bar" id="strengthBar"></div>
                        </div>
                        <p class="pwd-help">
                            <i class="bi bi-info-circle"></i>
                            Au moins 8 caractères, incluez majuscules, minuscules et chiffres
                        </p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">
                            <i class="bi bi-shield-check"></i>
                            Confirmer le mot de passe
                        </label>
                        <div class="input-group">
                            <i class="bi bi-shield-check input-icon"></i>
                            <input 
                                type="password" 
                                name="new_password2" 
                                id="new_password2"
                                class="form-control" 
                                placeholder="Répétez le mot de passe"
                                required
                            >
                            <button type="button" class="password-toggle" onclick="togglePassword('new_password2', 'icon2')">
                                <i class="bi bi-eye" id="icon2"></i>
                            </button>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn-reset">
                        <i class="bi bi-check-circle"></i>
                        <span>Réinitialiser mon mot de passe</span>
                    </button>
                </form>
            </div>
            
            <div class="reset-footer">
                <p>Vous vous souvenez de votre mot de passe ? <a href="/accounts/login/">Se connecter</a></p>
            </div>
        </div>
    </div>
    
    <script>
        function togglePassword(inputId, iconId) {
            const input = document.getElementById(inputId);
            const icon = document.getElementById(iconId);
            
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('bi-eye');
                icon.classList.add('bi-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('bi-eye-slash');
                icon.classList.add('bi-eye');
            }
        }
        
        function checkPasswordStrength() {
            const password = document.getElementById('new_password1').value;
            const strengthBar = document.getElementById('strengthBar');
            
            strengthBar.className = 'strength-bar';
            
            if (password.length === 0) {
                strengthBar.style.width = '0';
                return;
            }
            
            let strength = 0;
            if (password.length >= 8) strength++;
            if (password.match(/[a-z]/) && password.match(/[A-Z]/)) strength++;
            if (password.match(/\d/)) strength++;
            if (password.match(/[^a-zA-Z\d]/)) strength++;
            
            if (strength <= 1) {
                strengthBar.classList.add('strength-weak');
            } else if (strength <= 3) {
                strengthBar.classList.add('strength-medium');
            } else {
                strengthBar.classList.add('strength-strong');
            }
        }
    </script>
</body>
</html>
